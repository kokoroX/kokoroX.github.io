<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>mac 10.10.5 下nginx+php的配置 | kokoro&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="捣腾mac的php运行环境浪费了一天时间 所以打算整理一下 以便以后自己要是再有需求不用像这次这么折腾..
安装homebrew
参考别人安装nginx文章的时候发现这个东西。是个类似ubuntu的apt-get和nodejs里的npm命令的管理工具,可以让你安装各种软件的时候爽一点。。
下面是安装的命令,需要ruby环境 mac里默认是已安装的:
1$ ruby -e &quot;$(curl -fsSL">
<meta property="og:type" content="article">
<meta property="og:title" content="mac 10.10.5 下nginx+php的配置">
<meta property="og:url" content="http://kokorosblog.com/2015/09/26/mac下nginx-php的配置/index.html">
<meta property="og:site_name" content="kokoro's blog">
<meta property="og:description" content="捣腾mac的php运行环境浪费了一天时间 所以打算整理一下 以便以后自己要是再有需求不用像这次这么折腾..
安装homebrew
参考别人安装nginx文章的时候发现这个东西。是个类似ubuntu的apt-get和nodejs里的npm命令的管理工具,可以让你安装各种软件的时候爽一点。。
下面是安装的命令,需要ruby环境 mac里默认是已安装的:
1$ ruby -e &quot;$(curl -fsSL">
<meta property="og:image" content="http://7xk1zf.com1.z0.glb.clouddn.com/blognginx+php.png">
<meta property="og:updated_time" content="2015-09-27T03:42:11.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mac 10.10.5 下nginx+php的配置">
<meta name="twitter:description" content="捣腾mac的php运行环境浪费了一天时间 所以打算整理一下 以便以后自己要是再有需求不用像这次这么折腾..
安装homebrew
参考别人安装nginx文章的时候发现这个东西。是个类似ubuntu的apt-get和nodejs里的npm命令的管理工具,可以让你安装各种软件的时候爽一点。。
下面是安装的命令,需要ruby环境 mac里默认是已安装的:
1$ ruby -e &quot;$(curl -fsSL">
  
    <link rel="alternative" href="/atom.xml" title="kokoro&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body class='theme-helkyle 
  
    style-light
  '>

  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <div id="logo-wrap">
        <a href="/" id="logo"  >
          
            <img src="http://7xk1zf.com1.z0.glb.clouddn.com/killua.jpg" id="logo-img" >
           
          <span class='site-name'>kokoro&#39;s blog</span>
        </a>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/tags">标签</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
          <a class="main-nav-link" href="https://github.com/kokoroX">github</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="nav-search-wrap">
          <a id="nav-search-btn" class="nav-icon" title="Search"></a>  
          <div id="search-form-wrap">
              
  <!-- google搜索结束 -->
  <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://kokorosblog.com"></form>
  <!-- google搜索结束 -->

          </div>
        </div>
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-mac下nginx-php的配置" class="article article-type-post" itemscope itemprop="blogPost">
<!--   <div class="article-meta">
    <a href="/2015/09/26/mac下nginx-php的配置/" class="article-date">
  <time datetime="2015-09-26T15:24:41.000Z" itemprop="datePublished">2015-09-26</time>
</a>
    
  </div> -->
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      mac 10.10.5 下nginx+php的配置
    </h1>
  

        <span class="article__header-item article__header-postdate">
	发布于
	<time datetime="2015-09-26T15:24:41.000Z" itemprop="datePublished">2015-09-26</time>
</span>



	|<span class='article__header-item article__header-comments'>
		<a href="/2015/09/26/mac下nginx-php的配置/#comments ">
			<span class="ds-thread-count" data-thread-key="2015/09/26/mac下nginx-php的配置/" data-count-type="comments" >暂无评论</span>
		</a>
	</span>

      </header>
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
          
            <p>捣腾mac的php运行环境浪费了一天时间 所以打算整理一下 以便以后自己要是再有需求不用像这次这么折腾..</p>
<h2 id="安装homebrew">安装homebrew</h2><hr>
<p>参考别人安装nginx文章的时候发现这个东西。是个类似ubuntu的apt-get和nodejs里的npm命令的管理工具,可以让你安装各种软件的时候爽一点。。</p>
<p>下面是安装的命令,需要ruby环境 mac里默认是已安装的:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ruby <span class="operator">-e</span> <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure>
<p>顺便记录一下常用的命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ brew update <span class="comment">#更新可安装包的最新信息,建议每次安装前运行一下</span></span><br><span class="line">$ brew search package_name <span class="comment">#搜索package_name相关的包信息</span></span><br><span class="line">$ brew install package_name <span class="comment">#安装package_name的包</span></span><br></pre></td></tr></table></figure>
<p>然后是这是<a href="http://brew.sh/" target="_blank" rel="external">homebrew的官网地址</a></p>
<h2 id="安装nginx">安装nginx</h2><hr>
<p>之后安装nginx的过程就十分轻松加愉快了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ brew search nginx</span><br><span class="line">$ brew install nginx</span><br></pre></td></tr></table></figure>
<p>我安装的是1.8.0版本的</p>
<h2 id="配置">配置</h2><hr>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/etc/nginx/ <span class="comment">#这是nginx默认的安装路径</span></span><br><span class="line">$ vim nginx.conf <span class="comment">#nginx服务公用的配置文件</span></span><br></pre></td></tr></table></figure>
<p>nginx.conf配置成如下内容:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  <span class="number">1</span>; <span class="comment">#nginx进程数,建议设置为cpu总核心数</span></span><br><span class="line"></span><br><span class="line">error_<span class="built_in">log</span>       /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/nginx/error.log warn; <span class="comment">#全局错误日志存放路径 warn是类型</span></span><br><span class="line"></span><br><span class="line">pid        /usr/<span class="built_in">local</span>/var/run/nginx.pid; <span class="comment">#进程所用pid配置文件</span></span><br><span class="line"><span class="comment">#事件模块相关配置</span></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  <span class="number">256</span>; <span class="comment">#进程最大链接数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#http服务器相关配置 http层</span></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types; <span class="comment">#文件扩展名与文件类型映射表</span></span><br><span class="line">    default_<span class="built_in">type</span>  application/octet-stream; <span class="comment">#默认文件类型</span></span><br><span class="line">    <span class="comment">#日志格式设定</span></span><br><span class="line">    <span class="built_in">log</span>_format  main  <span class="string">'$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;</span><br><span class="line"></span><br><span class="line">    access_<span class="built_in">log</span>      /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/nginx/access.log main; <span class="comment">#定义本虚拟主机的访问日志</span></span><br><span class="line">    port_<span class="keyword">in</span>_redirect off; <span class="comment">#将不会在网站后面加上监听的端口</span></span><br><span class="line">    sendfile        on; <span class="comment">#开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。</span></span><br><span class="line">    keepalive_timeout  <span class="number">65</span>; <span class="comment">#长链接超时时间,单位是秒</span></span><br><span class="line"></span><br><span class="line">    include /usr/<span class="built_in">local</span>/etc/nginx/conf.d/*.conf; <span class="comment">#引入路径下的所有配置文件,用于将后面一个server层的配置文件引入进来</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在当前目录下新建一个目录及配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir conf.d &amp;&amp; <span class="built_in">cd</span> conf.d</span><br><span class="line">$ vim default.conf</span><br></pre></td></tr></table></figure>
<p>以下是default.conf的内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#虚拟主机的配置</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">8080</span>; <span class="comment">#监听的端口</span></span><br><span class="line">    server_name  localhost; <span class="comment">#域名,可以有多个,用空格分隔</span></span><br><span class="line"></span><br><span class="line">    root /Users/user_name/nginx_sites/; <span class="comment">#该项要修改为你准备存放相关网页的路径</span></span><br><span class="line"></span><br><span class="line">    location / &#123; </span><br><span class="line">        index index.html index.php; <span class="comment">#默认加载文件,可以有多个,用空格分隔</span></span><br><span class="line">        autoindex on; <span class="comment">#开启目录列表访问,适合下载服务器,默认关闭</span></span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">    <span class="comment">#proxy the php scripts to php-fpm php脚本文件代理给php-fpm执行</span></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        include /usr/<span class="built_in">local</span>/etc/nginx/fastcgi.conf; <span class="comment">#引入nginx默认fastcgi配置文件</span></span><br><span class="line">        fastcgi_intercept_errors on; <span class="comment">#是否显示5xx错误或者4xx错误给客户看</span></span><br><span class="line">        fastcgi_pass   <span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">9000</span>; <span class="comment">#fastcgi所监听的端口</span></span><br><span class="line">    &#125;   </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="安装php-fpm">安装php-fpm</h2><hr>
<p>mac中已经默认安装了php-fpm,不过得简单的修改一下配置文件<br>我就是卡在这一步浪费了好多时间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo cp /private/etc/php-fpm.conf.default /private/etc/php-fpm.conf</span><br><span class="line">$ vim /private/etc/php-fpm.conf</span><br></pre></td></tr></table></figure>
<p>找到error_log项 去掉行首的#注释,并且修改为error_log = /usr/local/var/log/php-fpm.log 不修改的话会报路径错误。</p>
<h2 id="测试nginx服务">测试nginx服务</h2><hr>
<p>在你所配置的nginx配置文件的root项所写路径下随便创建测试文件index.php 内容可自行填写<br>启动nginx服务，sudo nginx；<br>修改配置文件，重启nginx服务，sudo nginx -s reload<br>启动php服务，sudo php-fpm；<br>在浏览器地址栏中输入localhost:8080，如果配置正确地话，应该能看到PHP输出的页面。</p>
<h2 id="参考资料">参考资料</h2><hr>
<ol>
<li><a href="http://my.oschina.net/chen0dgax/blog/190161#OSC_h2_3" target="_blank" rel="external">Mac OSX 10.9搭建nginx+mysql+php-fpm环境</a></li>
<li><a href="http://www.ha97.com/5194.html" target="_blank" rel="external">（总结）Nginx配置文件nginx.conf中文详解</a></li>
</ol>
<p>最后配一张配置成功的图</p>
<p><img src="http://7xk1zf.com1.z0.glb.clouddn.com/blognginx+php.png" alt="配置成功"><br>比较懒 mysql的配置等下次用到再补上。。</p>

          
      

      
      
    </div>
    <footer class="article-footer">
      
        <div class="author__meta">
            <div class='autorh__avatar-wrap'>
              <a href=""><div class="author__avatar"></div></a>
            </div>
            <h3 class='author__name'>kokoro</h3>
            
              <ul class="social">
	
	  <li><a class="github" href="https://github.com/kokoroX" title="github">github</a></li>
	
</ul> 
            
            
              <p class='author__desc'>一步一步。</p>
            
        </div>
      
      <div class='article-subfooter'>
        <a data-url="http://kokorosblog.com/2015/09/26/mac下nginx-php的配置/" data-id="cif1ynd5c0003a46dx4qif0fu" data-title="mac 10.10.5 下nginx+php的配置" class="article-share-link">Share</a>
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>

      </div>
      
      
          
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2015/09/26/欢迎来到我的博客/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">欢迎来到我的博客</div>
    </a>
  
</nav>

  
</article>
  

  <div id="comments">
    
    
  
    
    
  

  <section id='duoshuo-comments'>
    <div class="ds-thread" data-thread-key="2015/09/26/mac下nginx-php的配置/" data-title="mac 10.10.5 下nginx+php的配置" data-url="http://kokorosblog.com/2015/09/26/mac下nginx-php的配置/">
    <script type="text/javascript">
      var duoshuoQuery = {short_name:"kokoro"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
    </script>
  </section>
  
  </div>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info">
      &copy;徐佳栋's blog 
      
      
      2015 • All rights reserved.<br>
      Published with <a href="http://hexo.io/" target="_blank">Hexo</a> Theme by <a href="https://github.com/HelKyle/hexo-theme-helkyle" target="_blank">helkyle</a>
    </div>
    
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  <button class="btn btn--close">×</button>
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/tags" class="mobile-nav-link">标签</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
    <a href="https://github.com/kokoroX" class="mobile-nav-link">github</a>
  
</nav>
    <script src="http://libs.baidu.com/jquery/2.1.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>






	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?6a8d3d45d9e85a99479c4175d36dcc10";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


<script type="text/javascript" sync src="http://v3.jiathis.com/code/jia.js?uid=2059159" charset="utf-8"></script>
  </div>
</body>
</html>